{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/constants.ts"],"sourcesContent":["import { GasProfileKey, WorkRow } from \"./types\";\r\n\r\nexport const FIXED_RATES = {\r\n    PIECES_PER_YEAR: 345600,\r\n    ITEMS_PER_PAGE: 10,\r\n};\r\n\r\n// *** FINAL FIX: ใช้ค่า Gas Rate N2 ที่มีความละเอียดสูงที่สุด (เพื่อให้ Gas Cost/Piece ตรงเป๊ะ) ***\r\nexport const GAS_RATES_PER_MIN_FIXED: Record<GasProfileKey, number> = {\r\n    'air': 0.00,\r\n    'o2': 0.5762,\r\n    'n2': 38.24264635194587,\r\n};\r\n\r\nexport const BASE_AIR_COMP_COST_PER_HR = 5.405;\r\n\r\nexport const initialWorkRows: WorkRow[] = [\r\n    { work: \"Part 1\", shape: 'แผ่น (Plate)', dimension: \"\", thickness: 1.2, length: 6000, nesting: 15, speed: 8.5, timeNest: \"0:00\", timePart: \"0:32\" },\r\n];\r\n\r\nexport const LASER_TO_AUX_MAP: Record<string, { laserKw: number; laserAmpere: number; chillerKw: number; stabilizerKw: number }> = {\r\n    '1500W': { laserKw: 4.6, laserAmpere: 7.7, chillerKw: 1.5, stabilizerKw: 12 },\r\n    '2000W': { laserKw: 6.1, laserAmpere: 10.2, chillerKw: 1.8, stabilizerKw: 12 },\r\n    '3000W': { laserKw: 9.1, laserAmpere: 15.3, chillerKw: 2.5, stabilizerKw: 12 },\r\n    '4000W': { laserKw: 12.1, laserAmpere: 20.5, chillerKw: 4.2, stabilizerKw: 12 },\r\n    '6000W': { laserKw: 18.2, laserAmpere: 30.7, chillerKw: 4.8, stabilizerKw: 18 },\r\n    '8000W': { laserKw: 24.2, laserAmpere: 40.9, chillerKw: 9.5, stabilizerKw: 18 },\r\n    '12000W': { laserKw: 36.4, laserAmpere: 61.4, chillerKw: 12, stabilizerKw: 36 },\r\n    '20000W': { laserKw: 60.6, laserAmpere: 102.4, chillerKw: 16.5, stabilizerKw: 60 },\r\n    '30000W': { laserKw: 90.9, laserAmpere: 153.5, chillerKw: 22, stabilizerKw: 90},\r\n    '40000W': { laserKw: 121.2, laserAmpere: 204.7, chillerKw: 30, stabilizerKw: 120 },\r\n    '60000W': { laserKw: 181.8, laserAmpere: 307, chillerKw: 52, stabilizerKw: 180 },\r\n    '120000W': { laserKw: 363.6, laserAmpere: 614, chillerKw: 105, stabilizerKw: 360 },\r\n};\r\n\r\nexport const MACHINE_TYPE_OPTIONS: string[] = [\r\n    'Small-Small(1.5-3kW)', 'Small-Medium(1.5-3kW)', 'Small-Large(1.5-3kW)',\r\n    'Medium-Small(4-8kW)', 'Medium-Medium(4-8kW)', 'Medium-Large(4-8kW)',\r\n    'Large-Small(12-30kW)', 'Large-Medium(12-30kW)', 'Large-Large(12-30kW)',\r\n    'Extra Large-Small(40-120kW)', 'Extra Large-Medium(40-120kW)', 'Extra Large-Large(40-120kW)',\r\n];\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEO,MAAM,cAAc;IACvB,iBAAiB;IACjB,gBAAgB;AACpB;AAGO,MAAM,0BAAyD;IAClE,OAAO;IACP,MAAM;IACN,MAAM;AACV;AAEO,MAAM,4BAA4B;AAElC,MAAM,kBAA6B;IACtC;QAAE,MAAM;QAAU,OAAO;QAAgB,WAAW;QAAI,WAAW;QAAK,QAAQ;QAAM,SAAS;QAAI,OAAO;QAAK,UAAU;QAAQ,UAAU;IAAO;CACrJ;AAEM,MAAM,mBAAsH;IAC/H,SAAS;QAAE,SAAS;QAAK,aAAa;QAAK,WAAW;QAAK,cAAc;IAAG;IAC5E,SAAS;QAAE,SAAS;QAAK,aAAa;QAAM,WAAW;QAAK,cAAc;IAAG;IAC7E,SAAS;QAAE,SAAS;QAAK,aAAa;QAAM,WAAW;QAAK,cAAc;IAAG;IAC7E,SAAS;QAAE,SAAS;QAAM,aAAa;QAAM,WAAW;QAAK,cAAc;IAAG;IAC9E,SAAS;QAAE,SAAS;QAAM,aAAa;QAAM,WAAW;QAAK,cAAc;IAAG;IAC9E,SAAS;QAAE,SAAS;QAAM,aAAa;QAAM,WAAW;QAAK,cAAc;IAAG;IAC9E,UAAU;QAAE,SAAS;QAAM,aAAa;QAAM,WAAW;QAAI,cAAc;IAAG;IAC9E,UAAU;QAAE,SAAS;QAAM,aAAa;QAAO,WAAW;QAAM,cAAc;IAAG;IACjF,UAAU;QAAE,SAAS;QAAM,aAAa;QAAO,WAAW;QAAI,cAAc;IAAE;IAC9E,UAAU;QAAE,SAAS;QAAO,aAAa;QAAO,WAAW;QAAI,cAAc;IAAI;IACjF,UAAU;QAAE,SAAS;QAAO,aAAa;QAAK,WAAW;QAAI,cAAc;IAAI;IAC/E,WAAW;QAAE,SAAS;QAAO,aAAa;QAAK,WAAW;QAAK,cAAc;IAAI;AACrF;AAEO,MAAM,uBAAiC;IAC1C;IAAwB;IAAyB;IACjD;IAAuB;IAAwB;IAC/C;IAAwB;IAAyB;IACjD;IAA+B;IAAgC;CAClE","debugId":null}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/utils.ts"],"sourcesContent":["import {\r\n  CustomKwRates,\r\n  CustomRates,\r\n  DerivedResult,\r\n  WorkRow,\r\n  WorkShape,\r\n} from \"./types\";\r\n\r\nexport function thb(n: number) {\r\n  if (!isFinite(n) || n === null) return \"-\";\r\n  // ใช้ toLocaleString เพื่อให้แสดงผลเป็น THB และรักษาความแม่นยำ 2 ตำแหน่ง\r\n  return n.toLocaleString(\"th-TH\", {\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n  });\r\n}\r\n\r\nexport function num(n: number) {\r\n  if (!isFinite(n) || n === null) return \"-\";\r\n  return n.toLocaleString(\"th-TH\", { maximumFractionDigits: 2 });\r\n}\r\n\r\nexport const genId = () => Math.random().toString(36).slice(2, 9);\r\n\r\n// *** UTILITY: แปลงค่า String (เช่น \"5:16\") หรือ Number ให้เป็น นาที (Decimal) ***\r\nexport const parseTimeValueToMinutes = (value: any): number => {\r\n  const strValue = String(value || \"0\").trim();\r\n\r\n  // 1. รองรับรูปแบบ mm:ss หรือ hh:mm:ss\r\n  if (strValue.includes(\":\")) {\r\n    const parts = strValue.split(\":\").map((p: string) => parseFloat(p));\r\n\r\n    // mm:ss\r\n    if (parts.length === 2) {\r\n      return (parts[0] || 0) + (parts[1] || 0) / 60;\r\n    }\r\n    // hh:mm:ss\r\n    if (parts.length === 3) {\r\n      return parts[0] * 60 + parts[1] + parts[2] / 60;\r\n    }\r\n  }\r\n\r\n  // 2. รองรับเลขทศนิยม\r\n  let num = parseFloat(strValue);\r\n  if (isNaN(num)) return 0;\r\n\r\n  // ถ้าค่าน้อยกว่า 1 และมีจุดทศนิยมยาวๆ อาจเป็น Excel Time Serial (1.0 = 24ชม.)\r\n  if (num > 0 && num < 1 && String(value).includes(\".\")) {\r\n    return num;\r\n  }\r\n\r\n  return num;\r\n};\r\n\r\nexport const mapExcelToWorkRow = (data: any[]): WorkRow[] => {\r\n  if (!data || data.length < 2) return [];\r\n\r\n  const newRows: WorkRow[] = data\r\n    .slice(1)\r\n    .map((row) => {\r\n      const dimStr = String(row[1] || \"\").trim();\r\n      let finalShape: WorkShape = \"ท่อ (Pipe)\";\r\n      const platePattern = /[0-9]+(\\.[0-9]+)?\\s*[xX]\\s*[0-9]+(\\.[0-9]+)?/;\r\n      if (platePattern.test(dimStr)) {\r\n        finalShape = \"แผ่น (Plate)\";\r\n      }\r\n\r\n      // *** Logic ใหม่: เก็บค่า Time เป็น String เดิมๆ จาก Excel ***\r\n\r\n      // Col 6: Time Nest (หรือ Pierce Count)\r\n      const col6Raw = String(row[6] || \"\").trim();\r\n      let timeNestStr = \"0:00\";\r\n\r\n      if (col6Raw.includes(\":\")) {\r\n        // เป็นเวลา \"5:16\"\r\n        timeNestStr = col6Raw;\r\n      } else if (col6Raw.includes(\".\") && parseFloat(col6Raw) < 1) {\r\n        // เป็น Excel Serial Date (0.00xxxx) -> แปลงเป็นนาทีแล้วค่อยเก็บ?\r\n        const val = parseFloat(col6Raw);\r\n        if (val >= 1 && !col6Raw.includes(\".\")) {\r\n          timeNestStr = \"0:00\"; // Pierce Count, ignore time\r\n        }\r\n      } else {\r\n        // กรณีอื่นๆ เช่น ว่าง หรือ เลข 0\r\n        if (parseFloat(col6Raw) > 0 && !col6Raw.includes(\":\")) {\r\n          timeNestStr = \"0:00\";\r\n        }\r\n      }\r\n\r\n      // Col 7: Time Part (Process Time)\r\n      const col7Raw = String(row[7] || \"\").trim();\r\n      let timePartStr = col7Raw || \"0:00\";\r\n\r\n      return {\r\n        work: String(row[0] || \"\"),\r\n        shape: finalShape,\r\n        dimension: dimStr,\r\n        thickness: parseFloat(String(row[2] || 0)),\r\n        length: parseFloat(String(row[3] || 0)),\r\n        nesting: parseFloat(String(row[4] || 1)),\r\n        speed: parseFloat(String(row[5] || 0)),\r\n        timeNest: timeNestStr, // เก็บเป็น string \"5:16\"\r\n        timePart: timePartStr, // เก็บเป็น string \"0:32\"\r\n      };\r\n    })\r\n    .filter((r) => r.work && r.work.length > 0);\r\n\r\n  return newRows;\r\n};\r\n\r\n// **********************************\r\n// 3. CORE LOGIC (DERIVED COMPUTATION)\r\n// **********************************\r\n\r\nexport const calculateAllDerived = (\r\n  rows: WorkRow[],\r\n  customRates: CustomRates,\r\n  customKwRates: CustomKwRates\r\n): DerivedResult => {\r\n  // ใช้ parseTimeValueToMinutes แปลง string \"5:16\" เป็นตัวเลข 5.267 นาที เพื่อคำนวณ\r\n  const totalTimePartOnly = rows.reduce(\r\n    (sum, row) => sum + parseTimeValueToMinutes(row.timePart),\r\n    0\r\n  );\r\n  const totalTimeAll = rows.reduce(\r\n    (sum, row) =>\r\n      sum +\r\n      (parseTimeValueToMinutes(row.timePart) +\r\n        parseTimeValueToMinutes(row.timeNest)),\r\n    0\r\n  );\r\n\r\n  const totalNestingParts = rows.reduce(\r\n    (sum, row) => sum + parseFloat(String(row.nesting) || \"1\"),\r\n    0\r\n  );\r\n  const totalJobs = rows.length || 1;\r\n\r\n  const minutesPerJob = totalTimeAll / totalJobs;\r\n  const cuttingMinutesPerJob = totalTimePartOnly / totalJobs;\r\n\r\n  const minutesPerPiece =\r\n    totalNestingParts > 0 ? totalTimeAll / totalNestingParts : 0;\r\n  const avgNestingParts = totalJobs > 0 ? totalNestingParts / totalJobs : 1;\r\n\r\n  const pph = minutesPerPiece > 0 ? 60 / minutesPerPiece : 0;\r\n\r\n  const hoursPerMonthPossible =\r\n    customRates.hoursPerDay * customRates.workingDaysPerMonth;\r\n  const hoursPerMonth =\r\n    (hoursPerMonthPossible * customRates.loadFactorPct) / 100.0;\r\n  const monthlyPieces = pph * hoursPerMonth;\r\n\r\n  const monthlyJobs =\r\n    minutesPerJob > 0 ? (hoursPerMonth * 60) / minutesPerJob : 0;\r\n\r\n  const totalKwBeforeLoad = customKwRates.kwItems.reduce(\r\n    (s, it) => s + (Number(it.kw) || 0),\r\n    0\r\n  );\r\n  const totalKwAfterLoad =\r\n    (totalKwBeforeLoad * customRates.loadFactorPct) / 100.0;\r\n\r\n  const laserKw = Number(\r\n    customKwRates.kwItems.find((i) => i.id === \"laser\")?.kw || 0\r\n  );\r\n  const totalKwOther = totalKwBeforeLoad - laserKw;\r\n  const totalAmpere = (customKwRates.laserAmpere || 0) + totalKwOther * 1.8;\r\n\r\n  // *** FINAL FIX: การแปลงหน่วยค่าไฟฟ้า จาก / 74 เป็น / 60.0 (ถูกต้องตามตรรกะ)\r\n  const elecRateTHBPerMin = customRates.elecCostPerKwh / 60.0;\r\n  const elecPerMin = totalKwAfterLoad * elecRateTHBPerMin;\r\n  const airCoolingRateTHBPerMin = customRates.airCompCostPerHr / 60.0;\r\n  const gasRateTHBPerMin = customRates.gasRateTHBPerMin;\r\n\r\n  const elecPerJob = minutesPerJob * elecPerMin;\r\n  const gasPerJob = cuttingMinutesPerJob * gasRateTHBPerMin;\r\n\r\n  const airCoolingPerJob = minutesPerJob * airCoolingRateTHBPerMin;\r\n  const sparePartsTHBPerMonth = customRates.baseSparePartTHBPerMonth;\r\n  const sparePerJob = monthlyJobs > 0 ? sparePartsTHBPerMonth / monthlyJobs : 0;\r\n\r\n  const totalPerJob = elecPerJob + gasPerJob + sparePerJob + airCoolingPerJob;\r\n\r\n  const elecPerPiece = avgNestingParts > 0 ? elecPerJob / avgNestingParts : 0;\r\n  const gasPerPiece = avgNestingParts > 0 ? gasPerJob / avgNestingParts : 0;\r\n  const airCoolingPerPiece =\r\n    avgNestingParts > 0 ? airCoolingPerJob / avgNestingParts : 0;\r\n  const sparePerPiece =\r\n    monthlyPieces > 0 ? sparePartsTHBPerMonth / monthlyPieces : 0; // ใช้ monthlyPieces ตามตรรกะ Excel\r\n  const totalPerPiece =\r\n    elecPerPiece + gasPerPiece + sparePerPiece + airCoolingPerPiece;\r\n\r\n  const elecPerMonth = elecPerJob * monthlyJobs;\r\n  const gasPerMonth = gasPerJob * monthlyJobs;\r\n  const airCoolingPerMonth = airCoolingPerJob * monthlyJobs;\r\n\r\n  const totalPerMonthRaw =\r\n    elecPerMonth + gasPerMonth + sparePartsTHBPerMonth + airCoolingPerMonth;\r\n\r\n  return {\r\n    totalKw: totalKwBeforeLoad,\r\n    totalKwAfterLoad: totalKwAfterLoad,\r\n    totalAmpere: totalAmpere,\r\n    hoursPerMonth,\r\n    minutesPerPiece,\r\n    monthlyPieces,\r\n    avgNestingParts,\r\n\r\n    elecPerPiece,\r\n    sparePerPiece,\r\n    gasPerPiece,\r\n    airCoolingPerPiece,\r\n    totalPerPiece,\r\n\r\n    elecPerJob,\r\n    sparePerJob,\r\n    gasPerJob,\r\n    airCoolingPerJob,\r\n    totalPerJob,\r\n\r\n    elecPerMonth: elecPerMonth, \r\n    gasPerMonth: gasPerMonth,\r\n    airCoolingPerMonth: airCoolingPerMonth,\r\n    totalPerMonth: totalPerMonthRaw,\r\n    totalAnnualCost: totalPerMonthRaw * 12,\r\n  };\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 305, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/components/CostSummaryBill.tsx"],"sourcesContent":["import React from 'react';\r\nimport { CustomRates, DerivedResult } from '../types';\r\nimport { thb, num } from '../utils';\r\n\r\ninterface CostSummaryBillProps {\r\n    derived: DerivedResult;\r\n    activeGas: string;\r\n    customRates: CustomRates;\r\n    currentSelectionLabel: string;\r\n}\r\n\r\nconst CostSummaryBill: React.FC<CostSummaryBillProps> = ({ derived, activeGas, customRates, currentSelectionLabel }) => {\r\n\r\n    const annualElec = derived.elecPerMonth * 12;\r\n    const annualGas = derived.gasPerMonth * 12;\r\n    const annualSpare = customRates.baseSparePartTHBPerMonth * 12;\r\n    const annualAirCooling = derived.airCoolingPerMonth * 12;\r\n\r\n    return (\r\n        <div className=\"bg-white rounded-2xl shadow p-5 sticky top-6\">\r\n            <h2 className=\"text-lg font-semibold mb-2\">\r\n                สรุปผลการคำนวณ: <span className=\"text-blue-700\">{currentSelectionLabel}</span>\r\n            </h2>\r\n            <p className=\"text-xs text-gray-500 border-b pb-2 mb-3\">\r\n                *ค่า/เดือน และ /ปี คำนวณจาก Load Factor ของชิ้นงานที่เลือก\r\n            </p>\r\n\r\n            <div className=\"space-y-2 text-sm border-b pb-3 mb-3\">\r\n                <div className=\"flex justify-between\"><span>kW รวม (ใช้คำนวณ)</span><span className=\"font-bold text-red-600\">{num(derived.totalKwAfterLoad)} kW</span></div>\r\n                <div className=\"flex justify-between\"><span>นาที/ชิ้น (เฉลี่ย)</span><span className=\"font-semibold\">{num(derived.minutesPerPiece)} min</span></div>\r\n                <div className=\"flex justify-between\"><span>ชิ้น/เดือน (Projected)</span><span className=\"font-semibold\">{num(derived.monthlyPieces)} pcs</span></div>\r\n            </div>\r\n\r\n            <h3 className=\"font-semibold mb-2\">ต้นทุนต่อชิ้น (บาท/ชิ้น)</h3>\r\n            <div className=\"space-y-1 text-sm border-b pb-3 mb-3\">\r\n                <div className=\"flex justify-between\"><span>ไฟฟ้า</span><span className=\"font-semibold\">฿ {thb(derived.elecPerPiece)}</span></div>\r\n                <div className=\"flex justify-between\"><span>แก๊ส ({activeGas.toUpperCase()})</span><span className=\"font-semibold\">฿ {thb(derived.gasPerPiece)}</span></div>\r\n                <div className=\"flex justify-between\"><span>ค่าลม Cooling/Air Assist</span><span className=\"font-semibold text-orange-600\">฿ {thb(derived.airCoolingPerPiece)}</span></div>\r\n                <div className=\"flex justify-between\"><span>อะไหล่สิ้นเปลือง</span><span className=\"font-semibold\">฿ {thb(derived.sparePerPiece)}</span></div>\r\n                <div className=\"flex justify-between text-base mt-2\"><span className=\"font-bold\">รวมต้นทุนต่อชิ้น</span><span className=\"font-bold text-lg text-green-600\">฿ {thb(derived.totalPerPiece)}</span></div>\r\n            </div>\r\n\r\n            <h3 className=\"font-semibold mb-2\">ต้นทุนต่องาน (บาท/งาน)</h3>\r\n            <div className=\"space-y-1 text-sm border-b pb-3 mb-3\">\r\n                <p className=\"text-xs text-gray-500 mb-2\">อ้างอิงจากชิ้นงานเฉลี่ย: {num(derived.avgNestingParts)} ชิ้น/งาน</p>\r\n                <div className=\"flex justify-between\"><span>ไฟฟ้า</span><span className=\"font-semibold text-purple-700\">฿ {thb(derived.elecPerJob)}</span></div>\r\n                <div className=\"flex justify-between\"><span>แก๊ส ({activeGas.toUpperCase()})</span><span className=\"font-semibold text-purple-700\">฿ {thb(derived.gasPerJob)}</span></div>\r\n                <div className=\"flex justify-between\"><span>ค่าลม Cooling/Air Assist</span><span className=\"font-semibold text-orange-600\">฿ {thb(derived.airCoolingPerJob)}</span></div>\r\n                <div className=\"flex justify-between\"><span>อะไหล่สิ้นเปลือง</span><span className=\"font-semibold text-purple-700\">฿ {thb(derived.sparePerJob)}</span></div>\r\n                <div className=\"flex justify-between text-base mt-2\"><span className=\"font-bold\">รวมต้นทุนต่องาน</span><span className=\"font-bold text-lg text-purple-600\">฿ {thb(derived.totalPerJob)}</span></div>\r\n            </div>\r\n\r\n            <h3 className=\"font-semibold mb-2\">ต้นทุนรวม/เดือน (Projected)</h3>\r\n            <div className=\"space-y-1 text-sm border-b pb-3 mb-3\">\r\n                <div className=\"flex justify-between\"><span>ค่าไฟ/เดือน</span><span className=\"font-semibold\">฿ {thb(derived.elecPerMonth)}</span></div>\r\n                <div className=\"flex justify-between\"><span>แก๊ส/เดือน</span><span className=\"font-semibold\">฿ {thb(derived.gasPerMonth)}</span></div>\r\n                <div className=\"flex justify-between\"><span>ค่าลม Cooling/Air Assist</span><span className=\"font-semibold text-orange-600\">฿ {thb(derived.airCoolingPerMonth)}</span></div>\r\n                <div className=\"flex justify-between\"><span>อะไหล่สิ้นเปลือง/เดือน</span><span className=\"font-semibold\">฿ {thb(customRates.baseSparePartTHBPerMonth)}</span></div>\r\n                <div className=\"flex justify-between text-base mt-2\">\r\n                    <span className=\"font-bold\">รวมต่อเดือน</span>\r\n                    <span className=\"font-bold text-lg text-red-600\">฿ {thb(derived.totalPerMonth)}</span>\r\n                </div>\r\n            </div>\r\n\r\n            <h3 className=\"font-semibold mb-2\">ต้นทุนรวม/ปี (Projected)</h3>\r\n            <div className=\"space-y-1 text-sm\">\r\n                <div className=\"flex justify-between\"><span>ค่าไฟ/ปี</span><span className=\"font-semibold\">฿ {thb(annualElec)}</span></div>\r\n                <div className=\"flex justify-between\"><span>แก๊ส/ปี</span><span className=\"font-semibold\">฿ {thb(annualGas)}</span></div>\r\n                <div className=\"flex justify-between\"><span>ค่าลม Cooling/Air Assist</span><span className=\"font-semibold text-orange-600\">฿ {thb(annualAirCooling)}</span></div>\r\n                <div className=\"flex justify-between\"><span>อะไหล่สิ้นเปลือง/ปี</span><span className=\"font-semibold\">฿ {thb(annualSpare)}</span></div>\r\n                <div className=\"flex justify-between text-base mt-2\">\r\n                    <span className=\"font-bold\">รวมต่อปี</span>\r\n                    <span className=\"font-bold text-lg text-red-900\">฿ {thb(derived.totalAnnualCost)}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CostSummaryBill;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1081, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/components/MainCostSummaryTable.tsx"],"sourcesContent":["import React from 'react';\r\nimport { DerivedResult, WorkRow } from '../types';\r\nimport { thb } from '../utils';\r\n\r\ninterface MainCostSummaryTableProps {\r\n    derived: DerivedResult;\r\n    rows: WorkRow[];\r\n    currentSelectionLabel: string;\r\n}\r\n\r\nconst MainCostSummaryTable: React.FC<MainCostSummaryTableProps> = ({ derived, rows, currentSelectionLabel }) => {\r\n    return (\r\n        <section className=\"bg-white rounded-xl shadow-2xl p-6 border-t-8 border-blue-400\">\r\n            <h2 className=\"text-2xl font-bold text-blue-800 mb-6 border-b pb-2\">\r\n                สรุปผลรวมต้นทุนต่อชิ้นงาน ({currentSelectionLabel})\r\n            </h2>\r\n            <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full border-collapse\">\r\n                    <thead className=\"bg-blue-200\">\r\n                        <tr className=\"text-blue-800\">\r\n                            <th className=\"p-3 border\">จำนวนชิ้นงาน (รายการ)</th>\r\n                            <th className=\"p-3 border\">เวลาเฉลี่ย/ชิ้น (นาที)</th>\r\n                            <th className=\"p-3 border bg-green-300\">ต้นทุนรวม/ชิ้น (บาท)</th>\r\n                            <th className=\"p-3 border bg-red-300\">ต้นทุนรวม/เดือน (บาท)</th>\r\n                            <th className=\"p-3 border\">ต้นทุนรวม/ปี (บาท)</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr className=\"text-center even:bg-gray-50 transition duration-100\">\r\n                            <td className=\"p-2 border font-medium\">{rows.length} รายการ</td>\r\n                            <td className=\"p-2 border\">{derived.minutesPerPiece.toFixed(3)}</td>\r\n                            <td className=\"p-2 border bg-green-100 font-bold text-lg\">{derived.totalPerPiece.toFixed(3)}</td>\r\n                            <td className=\"p-2 border bg-red-100 font-bold\">{thb(derived.totalPerMonth)}</td>\r\n                            <td className=\"p-2 border font-semibold text-blue-700\">{thb(derived.totalAnnualCost)}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default MainCostSummaryTable;\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAQA,MAAM,uBAA4D,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,qBAAqB,EAAE;IACvG,qBACI,8OAAC;QAAQ,WAAU;;0BACf,8OAAC;gBAAG,WAAU;;oBAAsD;oBACpC;oBAAsB;;;;;;;0BAEtD,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAM,WAAU;;sCACb,8OAAC;4BAAM,WAAU;sCACb,cAAA,8OAAC;gCAAG,WAAU;;kDACV,8OAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,8OAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,8OAAC;wCAAG,WAAU;kDAA0B;;;;;;kDACxC,8OAAC;wCAAG,WAAU;kDAAwB;;;;;;kDACtC,8OAAC;wCAAG,WAAU;kDAAa;;;;;;;;;;;;;;;;;sCAGnC,8OAAC;sCACG,cAAA,8OAAC;gCAAG,WAAU;;kDACV,8OAAC;wCAAG,WAAU;;4CAA0B,KAAK,MAAM;4CAAC;;;;;;;kDACpD,8OAAC;wCAAG,WAAU;kDAAc,QAAQ,eAAe,CAAC,OAAO,CAAC;;;;;;kDAC5D,8OAAC;wCAAG,WAAU;kDAA6C,QAAQ,aAAa,CAAC,OAAO,CAAC;;;;;;kDACzF,8OAAC;wCAAG,WAAU;kDAAmC,IAAA,0HAAG,EAAC,QAAQ,aAAa;;;;;;kDAC1E,8OAAC;wCAAG,WAAU;kDAA0C,IAAA,0HAAG,EAAC,QAAQ,eAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO/G;uCAEe","debugId":null}},
    {"offset": {"line": 1247, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/components/EquipmentModal.tsx"],"sourcesContent":["import React from 'react';\r\nimport { CustomKwRates, CustomRates, DerivedResult, KwItem, SummaryOptions } from '../types';\r\nimport { num } from '../utils';\r\n\r\ninterface EquipmentModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    summary: SummaryOptions;\r\n    onUpdate: (field: keyof SummaryOptions, value: string) => void;\r\n    options: any;\r\n    customRates: CustomRates;\r\n    onRateUpdate: (field: keyof CustomRates, value: number) => void;\r\n    derived: DerivedResult;\r\n    customKwRates: CustomKwRates;\r\n    updateKw: (id: string, patch: Partial<KwItem>) => void;\r\n    updateLaserAmpere: (value: number) => void;\r\n    addKwRow: () => void;\r\n    removeKwRow: (id: string) => void;\r\n    onGasTypeChange: (type: 'Air' | 'Oxygen' | 'Nitrogen') => void;\r\n}\r\n\r\nconst Dropdown = ({\r\n    field, label, value, opts, disabled = false, onUpdate, onGasTypeChange\r\n}: {\r\n    field: keyof SummaryOptions, label: string, value: string, opts: string[], disabled?: boolean,\r\n    onUpdate: (field: keyof SummaryOptions, value: string) => void,\r\n    onGasTypeChange: (type: 'Air' | 'Oxygen' | 'Nitrogen') => void\r\n}) => (\r\n    <div className=\"flex flex-col justify-end space-y-1\">\r\n        <label className=\"block text-sm font-bold text-gray-700\">{label}</label>\r\n        <select\r\n            value={value}\r\n            onChange={(e) => {\r\n                const newValue = e.target.value;\r\n                if (field === 'gasType') {\r\n                    const newGasType = newValue as 'Air' | 'Oxygen' | 'Nitrogen';\r\n                    onGasTypeChange(newGasType);\r\n                } else {\r\n                    onUpdate(field, newValue);\r\n                }\r\n            }}\r\n            disabled={disabled}\r\n            className={`w-full border rounded-lg px-3 py-2 ${disabled ? 'bg-gray-100' : 'bg-white'} focus:ring-blue-400`}\r\n        >\r\n            {opts.map((opt: string) => (<option key={opt} value={opt}>{opt}</option>))}\r\n        </select>\r\n    </div>\r\n);\r\n\r\nconst CustomRateInput = ({\r\n    field, label, unit, value, onRateUpdate\r\n}: {\r\n    field: keyof CustomRates, label: string, unit: string, value: number,\r\n    onRateUpdate: (field: keyof CustomRates, value: number) => void\r\n}) => (\r\n    <div className=\"flex flex-col justify-end space-y-1\">\r\n        <label className=\"block text-sm font-bold text-gray-700\">{label}</label>\r\n        <input\r\n            type=\"number\" step=\"any\"\r\n            value={value}\r\n            onChange={(e) => {\r\n                const newValue = parseFloat(e.target.value);\r\n                if (!isNaN(newValue)) { onRateUpdate(field, newValue); }\r\n            }}\r\n            className={`w-full border rounded-lg px-3 py-2 ${field === 'gasRateTHBPerMin' ? 'bg-yellow-100 border-yellow-500 font-bold' : 'bg-white border-gray-300'} focus:ring-yellow-400`}\r\n        />\r\n        <p className=\"text-xs text-gray-500\">{unit}</p>\r\n    </div>\r\n);\r\n\r\nconst KwItemInput = ({\r\n    item, index, isLaser, updateKw, customKwRates, updateLaserAmpere, removeKwRow\r\n}: {\r\n    item: KwItem, index: number, isLaser: boolean,\r\n    updateKw: (id: string, patch: Partial<KwItem>) => void,\r\n    customKwRates: CustomKwRates,\r\n    updateLaserAmpere: (value: number) => void,\r\n    removeKwRow: (id: string) => void\r\n}) => (\r\n    <div className=\"col-span-1 border border-gray-300 p-3 rounded-md bg-white shadow-sm\">\r\n        <h5 className=\"text-sm font-bold text-blue-700 mb-2\">{item.name}</h5>\r\n\r\n        <div className=\"mb-2\">\r\n            <label className=\"block text-xs font-semibold text-gray-600\">กำลังไฟฟ้าจริง (kW)</label>\r\n            <input\r\n                type=\"number\" step=\"any\" min=\"0\"\r\n                value={item.kw}\r\n                onChange={(e) => updateKw(item.id, { kw: e.target.value })}\r\n                className=\"w-full border rounded-lg px-2 py-1 bg-white border-gray-300 focus:ring-blue-400 text-sm\"\r\n            />\r\n        </div>\r\n\r\n        {isLaser && (\r\n            <div>\r\n                <label className=\"block text-xs font-semibold text-gray-600\">กระแสไฟฟ้า (A)</label>\r\n                <input\r\n                    type=\"number\" step=\"any\" min=\"0\"\r\n                    value={customKwRates.laserAmpere}\r\n                    onChange={(e) => updateLaserAmpere(Number(e.target.value))}\r\n                    className=\"w-full border rounded-lg px-2 py-1 bg-blue-50 border-blue-400 font-medium focus:ring-blue-400 text-sm\"\r\n                />\r\n            </div>\r\n        )}\r\n\r\n        {index >= 6 && (\r\n            <button\r\n                onClick={() => removeKwRow(item.id)}\r\n                className=\"mt-2 text-red-500 text-xs hover:text-red-700\"\r\n            >\r\n                ลบรายการ\r\n            </button>\r\n        )}\r\n    </div>\r\n);\r\n\r\nconst EquipmentModal: React.FC<EquipmentModalProps> = ({\r\n    isOpen, onClose, summary, onUpdate, options, customRates, onRateUpdate,\r\n    derived, customKwRates, updateKw, updateLaserAmpere, addKwRow, removeKwRow, onGasTypeChange\r\n}) => {\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full z-50\" onClick={onClose}>\r\n            <div className=\"relative top-10 mx-auto p-8 border w-11/12 md:w-4/5 lg:w-4/5 xl:w-2/3 shadow-2xl rounded-xl bg-white\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"flex justify-between items-center border-b pb-3 mb-4\">\r\n                    <h3 className=\"text-2xl font-extrabold text-blue-800\">ตั้งค่าอุปกรณ์และโหมดการตัด (Equipment Configuration)</h3>\r\n                    <button onClick={onClose} className=\"text-red-500 hover:text-red-700 text-3xl font-light\">&times;</button>\r\n                </div>\r\n\r\n                <div className=\"space-y-8\">\r\n\r\n                    <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n                        <h4 className=\"text-lg font-bold text-blue-800 mb-3\">กำหนดกำลังไฟฟ้า (kW) และกระแสไฟฟ้า (A)</h4>\r\n\r\n                        <div className=\"mb-4\">\r\n                            <Dropdown\r\n                                field=\"laserPower\"\r\n                                label=\"1. Laser Power (เลือกเพื่อลิงก์ Chiller/Stabilizer kW)\"\r\n                                value={summary.laserPower}\r\n                                opts={options.laserPowerOptions}\r\n                                onUpdate={onUpdate}\r\n                                onGasTypeChange={onGasTypeChange}\r\n                            />\r\n                            <p className=\"text-xs text-gray-500 mt-1\">การเลือกนี้จะอัปเดตค่า kW ของ Laser Source, Chiller, และ Stabilizer รวมถึง Ampere ของ Laser Source อัตโนมัติ</p>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-2 gap-6\">\r\n                            {customKwRates.kwItems.map((item, index) => (\r\n                                item.id === 'machine' ? (\r\n                                    <div key={item.id} className=\"col-span-1 border border-gray-300 p-3 rounded-md bg-white shadow-sm\">\r\n                                        <Dropdown\r\n                                            field=\"machineType\"\r\n                                            label=\"4. Machine Type\"\r\n                                            value={summary.machineType}\r\n                                            opts={options.machineTypeOptions}\r\n                                            onUpdate={onUpdate}\r\n                                            onGasTypeChange={onGasTypeChange}\r\n                                        />\r\n                                    </div>\r\n                                ) : (\r\n                                    <KwItemInput\r\n                                        key={item.id}\r\n                                        item={item}\r\n                                        index={index}\r\n                                        isLaser={item.id === 'laser'}\r\n                                        updateKw={updateKw}\r\n                                        customKwRates={customKwRates}\r\n                                        updateLaserAmpere={updateLaserAmpere}\r\n                                        removeKwRow={removeKwRow}\r\n                                    />\r\n                                )\r\n                            ))}\r\n                        </div>\r\n                        <button onClick={addKwRow} className=\"mt-4 px-3 py-2 rounded-xl border bg-blue-700 text-white hover:bg-blue-800 text-sm shadow-sm\">+ เพิ่มรายการกำลังไฟอื่น ๆ</button>\r\n\r\n                        <div className=\"mt-4 p-3 bg-blue-100 rounded-md\">\r\n                            <p className=\"text-sm font-semibold text-blue-700\">Ampere รวมที่ใช้ในการคำนวณ (โดยประมาณ): <span className=\"text-red-600\">{num(derived.totalAmpere)} A</span></p>\r\n                            <p className=\"text-sm font-semibold text-blue-700\">kW รวมก่อน Load Factor: <span className=\"text-red-600\">{num(derived.totalKw)} kW</span></p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-300\">\r\n                        <h4 className=\"text-lg font-bold text-yellow-800 mb-3\">ปรับแต่งอัตราต้นทุนและการดำเนินงาน</h4>\r\n                        <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-6 mb-4\">\r\n                            <CustomRateInput\r\n                                field=\"elecCostPerKwh\"\r\n                                label=\"7. ค่าไฟฟ้า\"\r\n                                unit=\"THB/kWh (บาท/หน่วย)\"\r\n                                value={customRates.elecCostPerKwh}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <CustomRateInput\r\n                                field=\"baseSparePartTHBPerMonth\"\r\n                                label=\"8. ค่า Spare Part (ฐาน)\"\r\n                                unit=\"THB/เดือน (ใช้ในการคำนวณต้นทุนหลัก)\"\r\n                                value={customRates.baseSparePartTHBPerMonth}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <CustomRateInput\r\n                                field=\"gasRateTHBPerMin\"\r\n                                label=\"9. ค่า Gas/min\"\r\n                                unit=\"THB/min (ค่าเริ่มต้นปรับตาม Gas Type)\"\r\n                                value={customRates.gasRateTHBPerMin}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <CustomRateInput\r\n                                field=\"loadFactorPct\"\r\n                                label=\"10. Load Factor\"\r\n                                unit=\"(0 - 100) %\"\r\n                                value={customRates.loadFactorPct}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-6 border-t pt-4 border-yellow-300\">\r\n                            <CustomRateInput\r\n                                field=\"airCompCostPerHr\"\r\n                                label=\"11. ค่าบำรุงรักษา Air Comp\"\r\n                                unit=\"THB/Hr (ใช้คิดค่าลม Cooling/Assist)\"\r\n                                value={customRates.airCompCostPerHr}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <CustomRateInput\r\n                                field=\"hoursPerDay\"\r\n                                label=\"12. ชั่วโมงทำงาน/วัน\"\r\n                                unit=\"Hrs/Day\"\r\n                                value={customRates.hoursPerDay}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <CustomRateInput\r\n                                field=\"workingDaysPerMonth\"\r\n                                label=\"13. วันทำงาน/เดือน\"\r\n                                unit=\"Days/Month\"\r\n                                value={customRates.workingDaysPerMonth}\r\n                                onRateUpdate={onRateUpdate}\r\n                            />\r\n                            <div className=\"text-sm font-semibold text-gray-700 col-span-2 flex items-center justify-center\">\r\n                                <div className=\"p-3 bg-yellow-100 rounded-md\">\r\n                                    ชั่วโมงทำงานต่อเดือน:\r\n                                    <span className=\"text-red-600 ml-2 text-md\">{num(derived.hoursPerMonth)} Hrs</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6\">\r\n\r\n                        <Dropdown field=\"gasType\" label=\"15. Gas Type\" value={summary.gasType} opts={options.gasTypeOptions} onUpdate={onUpdate} onGasTypeChange={onGasTypeChange} />\r\n                        <Dropdown field=\"machineGeometry\" label=\"16. Machine Geometry\" value={summary.machineGeometry} opts={options.machineGeometryOptions} onUpdate={onUpdate} onGasTypeChange={onGasTypeChange} />\r\n                        <Dropdown field=\"nozzle\" label=\"17. Nozzle\" value={summary.nozzle} opts={options.nozzleTypes} onUpdate={onUpdate} onGasTypeChange={onGasTypeChange} />\r\n                        <Dropdown field=\"cuttingMode\" label=\"18. Cutting Mode\" value={summary.cuttingMode} opts={options.cuttingModes} onUpdate={onUpdate} onGasTypeChange={onGasTypeChange} />\r\n                    </div>\r\n\r\n                    <div className=\"mt-8 flex justify-center\">\r\n                        <button onClick={onClose} className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-3 rounded-lg shadow-lg transition duration-150\">\r\n                            ยืนยันการตั้งค่า (Close)\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EquipmentModal;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1842, "column": 0}, "map": {"version":3,"sources":["file:///D:/test-app2/test-app1/test-app1/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useMemo } from \"react\";\nimport Image from 'next/image';\nimport * as XLSX from 'xlsx';\n\nimport {\n    WorkRow,\n    SummaryOptions,\n    CustomKwRates,\n    CustomRates,\n    GasProfileKey,\n    KwItem,\n    WorkShape\n} from \"./types\";\n\nimport {\n    FIXED_RATES,\n    GAS_RATES_PER_MIN_FIXED,\n    BASE_AIR_COMP_COST_PER_HR,\n    initialWorkRows,\n    LASER_TO_AUX_MAP,\n    MACHINE_TYPE_OPTIONS\n} from \"./constants\";\n\nimport {\n    genId,\n    mapExcelToWorkRow,\n    calculateAllDerived,\n    num\n} from \"./utils\";\n\nimport CostSummaryBill from \"./components/CostSummaryBill\";\nimport MainCostSummaryTable from \"./components/MainCostSummaryTable\";\nimport EquipmentModal from \"./components/EquipmentModal\";\n\nconst TakecoLaserCostV25: React.FC = () => {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [rows, setRows] = useState<WorkRow[]>(initialWorkRows);\n\n    const [selectedModel, setSelectedModel] = useState<'total' | number>('total');\n\n    const initialKwRates: CustomKwRates = {\n        kwItems: [\n            { id: 'laser', name: \"1. Laser Source (kW)\", kw: 9.1 },\n            { id: 'chiller', name: \"2. Chiller (kW)\", kw: 2.5 },\n            { id: 'stabilizer', name: \"3. Stabilizer (kW)\", kw: 6.8 },\n            { id: 'machine', name: \"4. Machine Type (kW)\", kw: 6 },\n            { id: 'aircomp', name: \"5. Air Compressor (kW)\", kw: 22 },\n            { id: 'dustcoll', name: \"6. Dust Collector (kW)\", kw: 3 },\n        ],\n        laserAmpere: 15.3,\n    };\n\n    const [customKwRates, setCustomKwRates] = useState<CustomKwRates>(initialKwRates);\n\n    const [customRates, setCustomRates] = useState<CustomRates>({\n        elecCostPerKwh: 4.5,\n        gasRateTHBPerMin: GAS_RATES_PER_MIN_FIXED['n2'],\n        // *** FINAL FIX: ปรับ Spare Part/เดือน ให้เป็น 625.0 THB/เดือน (ตรงตาม Excel) ***\n        baseSparePartTHBPerMonth: 625.0,\n\n        // ** Load Factor 80% **\n        loadFactorPct: 80,\n        workingDaysPerMonth: 22,\n        hoursPerDay: 8,\n\n        airCompCostPerHr: BASE_AIR_COMP_COST_PER_HR,\n    });\n\n    const [summary, setSummary] = useState<SummaryOptions>({\n        machineGeometry: 'Plate Cutting (ตัดแผ่น)',\n        gasType: 'Nitrogen',\n        nozzle: \"1.0mm\",\n        cuttingMode: \"Normal\",\n        laserPower: '3000W',\n        machineType: 'Small-Large(1.5-3kW)',\n    });\n\n    const getSelectedRows = (allRows: WorkRow[], selection: 'total' | number): WorkRow[] => {\n        if (selection === 'total') {\n            return allRows;\n        }\n        if (typeof selection === 'number' && allRows[selection]) {\n            return [allRows[selection]];\n        }\n        return allRows;\n    };\n\n    const derived = useMemo(() => {\n        const selectedRows = getSelectedRows(rows, selectedModel);\n        return calculateAllDerived(selectedRows, customRates, customKwRates);\n    }, [rows, customRates, customKwRates, selectedModel]);\n\n\n    // --- Handlers & Utils ---\n    const handleRateChange = (field: keyof CustomRates, value: number) => {\n        if (field === 'loadFactorPct') {\n            value = Math.max(0, Math.min(100, value));\n        }\n        setCustomRates(prev => ({ ...prev, [field]: value }));\n    };\n\n    const updateKw = (id: string, patch: Partial<KwItem>) => {\n        const next = customKwRates.kwItems.map((it) => (it.id === id ? { ...it, ...patch } : it));\n        setCustomKwRates(prev => ({ ...prev, kwItems: next }));\n    };\n\n    const updateLaserAmpere = (value: number) => {\n        setCustomKwRates(prev => ({ ...prev, laserAmpere: value }));\n    };\n\n    const addKwRow = () => {\n        setCustomKwRates(prev => ({\n            ...prev,\n            kwItems: [\n                ...prev.kwItems,\n                { id: genId(), name: `Device ${prev.kwItems.length + 1} (kW)`, kw: 0 },\n            ],\n        }));\n    };\n\n    const removeKwRow = (id: string) => {\n        setCustomKwRates(prev => ({\n            ...prev,\n            kwItems: prev.kwItems.filter((it) => it.id !== id)\n        }));\n    };\n\n    const handleGasTypeChange = (type: 'Air' | 'Oxygen' | 'Nitrogen') => {\n\n        let gasKey: GasProfileKey = 'air';\n        if (type === 'Oxygen') {\n            gasKey = 'o2';\n        } else if (type === 'Nitrogen') {\n            gasKey = 'n2';\n        } else {\n            gasKey = 'air';\n        }\n\n        const defaultRate = GAS_RATES_PER_MIN_FIXED[gasKey];\n\n        setSummary(prev => ({ ...prev, gasType: type }));\n        setCustomRates(prev => ({ ...prev, gasRateTHBPerMin: defaultRate || 0 }));\n    };\n\n    const handleSummaryChange = (field: keyof SummaryOptions, value: string) => {\n        setSummary(prev => {\n            let newState = { ...prev, [field]: value as any };\n\n            if (field === 'laserPower') {\n                const map = LASER_TO_AUX_MAP[value];\n                if (map) {\n                    setCustomKwRates(prevKw => {\n                        const nextKwItems = prevKw.kwItems.map(item => {\n                            if (item.id === 'laser') return { ...item, kw: map.laserKw };\n                            if (item.id === 'chiller') return { ...item, kw: map.chillerKw };\n                            if (item.id === 'stabilizer') return { ...item, kw: map.stabilizerKw };\n                            return item;\n                        });\n                        return { ...prevKw, kwItems: nextKwItems, laserAmpere: map.laserAmpere };\n                    });\n                }\n            }\n            return newState;\n        });\n    };\n\n    const totalPages = Math.ceil(rows.length / FIXED_RATES.ITEMS_PER_PAGE);\n    const startIndex = (currentPage - 1) * FIXED_RATES.ITEMS_PER_PAGE;\n    const currentRows = rows.slice(startIndex, startIndex + FIXED_RATES.ITEMS_PER_PAGE);\n\n    const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const file = event.target.files?.[0];\n        if (!file) return;\n        const fileType = file.name.split('.').pop()?.toLowerCase();\n        if (fileType === 'xlsx' || fileType === 'xls') {\n            const reader = new FileReader();\n            reader.onload = (e) => {\n                const data = new Uint8Array(e.target!.result as ArrayBuffer);\n                const workbook = XLSX.read(data, { type: 'array' });\n                const sheetName = workbook.SheetNames[0];\n                const worksheet = workbook.Sheets[sheetName];\n                const jsonSheet: any[] = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n                if (jsonSheet.length > 1) {\n                    const mappedRows = mapExcelToWorkRow(jsonSheet);\n                    if (mappedRows.length > 0) {\n                        setRows(mappedRows);\n                        setCurrentPage(1);\n                        setSelectedModel('total');\n                        alert(`นำเข้าข้อมูล ${mappedRows.length} ชิ้นงานจากไฟล์ Excel สำเร็จ`);\n                    } else {\n                        alert(\"ไม่พบข้อมูลชิ้นงานที่ถูกต้องในไฟล์ Excel (โปรดตรวจสอบรูปแบบ)\");\n                    }\n                } else {\n                    alert(\"ไฟล์ Excel ว่างเปล่าหรือไม่ถูกต้อง\");\n                }\n            };\n            reader.readAsArrayBuffer(file);\n        } else {\n            alert(\"ไฟล์ PDF ไม่สามารถประมวลผลข้อมูลตารางที่ซับซ้อนในเบราว์เซอร์ได้ กรุณาใช้ไฟล์ Excel (.xlsx) เพื่อการนำเข้าที่แม่นยำ\");\n        }\n        event.target.value = '';\n    };\n\n    const handleInputChange = (index: number, field: keyof WorkRow, value: string) => {\n        const newRows = [...rows];\n        const globalIndex = startIndex + index;\n\n        if (field === 'shape') {\n            newRows[globalIndex] = {\n                ...newRows[globalIndex],\n                [field]: value as WorkShape,\n            };\n        } else {\n            newRows[globalIndex] = { ...newRows[globalIndex], [field]: value };\n        }\n        setRows(newRows);\n    };\n\n    const addRow = () => {\n        setRows(prev => [\n            ...prev,\n            { work: `Part ${prev.length + 1}`, shape: 'แผ่น (Plate)', dimension: \"\", thickness: \"\", length: \"\", nesting: 1, speed: \"\", timeNest: \"0:00\", timePart: \"0.53\" },\n        ]);\n    };\n\n    const removeRow = (index: number) => {\n        const globalIndex = startIndex + index;\n        const newRows = rows.filter((_, i) => i !== globalIndex);\n        setRows(newRows);\n        if (currentRows.length === 1 && currentPage > 1 && newRows.length > 0) {\n            setCurrentPage(currentPage - 1);\n        }\n    };\n\n    const workRowFields: { key: keyof WorkRow, label: string }[] = [\n        { key: 'work', label: 'Work Name' },\n        { key: 'shape', label: 'Shape' },\n        { key: 'dimension', label: 'Dimension ' },\n        { key: 'thickness', label: 'Thickness (mm)' },\n        { key: 'length', label: 'Length (mm)' },\n        { key: 'nesting', label: 'Nesting ' },\n        { key: 'speed', label: 'Speed (m/min)' },\n        { key: 'timeNest', label: 'Time Nest (mm:ss)' },\n        { key: 'timePart', label: 'Time Part (mm:ss)' },\n    ];\n\n    const dropdownOptions = {\n        laserPowerOptions: Object.keys(LASER_TO_AUX_MAP),\n        machineTypeOptions: MACHINE_TYPE_OPTIONS,\n        machineGeometryOptions: ['Plate Cutting (ตัดแผ่น)', 'Pipe Cutting (ตัดท่อ)'],\n        gasTypeOptions: [\"Air\", \"Oxygen\", \"Nitrogen\"],\n        nozzleTypes: [\"1.0mm\", \"1.2mm\", \"1.5mm\", \"2.0mm\"],\n        cuttingModes: [\"Normal\", \"Fine\", \"HighSpeed\"],\n    };\n\n    const modelOptions = [\n        { value: 'total', label: `รวม ${rows.length} โมเดล (Overall Average)` },\n        ...rows.map((row, index) => ({\n            value: index as number,\n            label: `${index + 1}. ${row.work}`\n        }))\n    ];\n    const currentSelectionLabel = modelOptions.find(opt => opt.value === selectedModel)?.label || modelOptions[0].label;\n\n\n    return (\n        <div className=\"min-h-screen bg-gray-100 text-gray-900 font-sans\">\n            <header className=\"bg-blue-900 text-white p-4 shadow-xl flex items-center space-x-4\">\n                <Image\n                    src=\"/LogoTakeco Laser.jpg\"\n                    alt=\"Takeco Laser Logo\"\n                    width={50}\n                    height={50}\n                    className=\"rounded-full\"\n                />\n                <div>\n                    <h1 className=\"text-3xl font-extrabold tracking-tight\">\n                        Takeco Laser Operation Cost \n                    </h1>\n                    <p className=\"text-sm font-light mt-1\">\n                        จัดทำโดย: บริษัท ทาเคโกะ เอ็นจิเนียริ่ง (ประเทศไทย) จำกัด\n                    </p>\n                </div>\n            </header>\n\n            <main className=\"max-w-7xl mx-auto p-8\">\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n\n                    <div className=\"lg:col-span-2 space-y-8\">\n\n                        <section className=\"bg-white rounded-xl shadow-2xl p-6 border-t-8 border-blue-700\">\n                            <h2 className=\"text-2xl font-bold text-blue-800 mb-6 border-b pb-2\"> ชิ้นงานและพารามิเตอร์การตัด (Work Piece Input)</h2>\n\n                            <div className=\"mb-4 flex items-center space-x-3\">\n                                <label className=\"bg-green-600 hover:bg-green-700 text-white font-semibold px-4 py-2 rounded-md shadow cursor-pointer transition duration-150\">\n                                    📂 Import Data from Excel\n                                    <input\n                                        type=\"file\"\n                                        accept=\".xlsx, .xls, .pdf\"\n                                        onChange={handleFileUpload}\n                                        className=\"hidden\"\n                                    />\n                                </label>\n                                <span className=\"text-sm text-gray-500\">\n                                    (Total Parts: {rows.length})\n                                </span>\n                            </div>\n\n                            <div className=\"overflow-x-auto\">\n                                <table className=\"w-full border-collapse rounded-lg overflow-hidden\">\n                                    <thead className=\"bg-blue-600 text-white\">\n                                        <tr>\n                                            <th className=\"p-3 border border-blue-700 text-sm font-medium\">No.</th>\n                                            {workRowFields.map(({ key, label }) => (<th key={key} className=\"p-3 border border-blue-700 text-sm font-medium\">{label}</th>))}\n                                            <th className=\"p-3 border border-blue-700\">Action</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        {currentRows.map((row, i) => (\n                                            <tr key={startIndex + i} className=\"text-center even:bg-gray-50 transition duration-100\">\n                                                <td className=\"p-2 border border-gray-300 font-medium\">\n                                                    {(startIndex + i) + 1}\n                                                </td>\n                                                {workRowFields.map(({ key }) => (\n                                                    <td key={key} className=\"p-2 border border-gray-300\">\n                                                        {key === 'shape' ? (\n                                                            <select value={row.shape} onChange={(e) => handleInputChange(i, key, e.target.value)} className=\"w-full border rounded-md px-2 py-1 bg-white focus:ring-2 focus:ring-blue-400\">\n                                                                {['แผ่น (Plate)', 'ท่อ (Pipe)'].map(shape => (<option key={shape} value={shape}>{shape}</option>))}\n                                                            </select>\n                                                        ) : (\n                                                            <>\n                                                                <input\n                                                                    type={['thickness', 'length', 'nesting', 'speed'].includes(key) ? 'number' : 'text'}\n                                                                    value={String(row[key])}\n                                                                    onChange={(e: React.ChangeEvent<HTMLInputElement>) => handleInputChange(i, key, e.target.value)}\n                                                                    // ปลดล็อก Dimension ให้กรอกได้อิสระ\n                                                                    disabled={false}\n                                                                    className={`w-full border rounded-md px-2 py-1 focus:ring-2 focus:ring-blue-400 transition border-gray-300`}\n                                                                    min={0}\n                                                                />\n                                                            </>\n                                                        )}\n                                                    </td>\n                                                ))}\n                                                <td className=\"p-2 border border-gray-300\">\n                                                    <button onClick={() => removeRow(i)} className=\"bg-red-500 text-white w-full px-3 py-1 rounded-full text-lg hover:bg-red-600 shadow-md\">&times;</button>\n                                                </td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n\n                            {rows.length > FIXED_RATES.ITEMS_PER_PAGE && (\n                                <div className=\"flex justify-between items-center mt-4\">\n                                    <span className=\"text-sm text-gray-600\">แสดงรายการที่ {startIndex + 1} - {Math.min(startIndex + FIXED_RATES.ITEMS_PER_PAGE, rows.length)} จาก {rows.length} รายการ</span>\n                                    <div>\n                                        <button\n                                            onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n                                            disabled={currentPage === 1}\n                                            className=\"px-3 py-1 mr-2 border rounded-md bg-gray-100 disabled:opacity-50\"\n                                        >\n                                            &lt; Prev\n                                        </button>\n                                        <span className=\"font-semibold\">{currentPage} / {totalPages}</span>\n                                        <button\n                                            onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n                                            disabled={currentPage === totalPages}\n                                            className=\"px-3 py-1 ml-2 border rounded-md bg-gray-100 disabled:opacity-50\"\n                                        >\n                                            Next &gt;\n                                        </button>\n                                    </div>\n                                </div>\n                            )}\n\n                            <button onClick={addRow} className=\"mt-4 bg-blue-700 hover:bg-blue-800 text-white font-semibold px-6 py-2 rounded-lg shadow-lg transition duration-150 flex items-center space-x-2\">\n                                <span className=\"text-xl\">+</span>\n                                <span>เพิ่มชิ้นงาน</span>\n                            </button>\n                        </section>\n\n                        <section className=\"bg-white rounded-xl shadow-2xl p-6 border-t-8 border-purple-500 flex justify-between items-center\">\n                            <div>\n                                <h2 className=\"text-2xl font-bold text-purple-800\">ข้อมูลเครื่องจักรและตัวเลือกการตัด</h2>\n                                <p className=\"text-sm text-gray-500 mt-1\">คลิกปุ่มด้านข้างเพื่อกำหนดค่ากำลังไฟฟ้า (kW) และอัตราต้นทุนเอง</p>\n                                <p className=\"text-md font-semibold mt-2 text-green-600\">สถานะ: Total kW: {num(derived.totalKwAfterLoad)} / Gas: {summary.gasType} / Load Factor: {customRates.loadFactorPct}%</p>\n                            </div>\n                            <button\n                                onClick={() => setIsModalOpen(true)}\n                                className=\"bg-purple-600 hover:bg-purple-700 text-white font-semibold px-6 py-3 rounded-lg shadow-lg transition duration-150\"\n                            >\n                                <span className=\"text-xl mr-2\">⚙️</span> ตั้งค่าอุปกรณ์ & ดูสรุปผล\n                            </button>\n                        </section>\n\n                        <MainCostSummaryTable derived={derived} rows={rows} currentSelectionLabel={currentSelectionLabel} />\n\n                        <EquipmentModal\n                            isOpen={isModalOpen}\n                            onClose={() => setIsModalOpen(false)}\n                            summary={summary}\n                            onUpdate={handleSummaryChange}\n                            options={dropdownOptions}\n                            derived={derived}\n                            customRates={customRates}\n                            onRateUpdate={handleRateChange}\n                            customKwRates={customKwRates}\n                            updateKw={updateKw}\n                            updateLaserAmpere={updateLaserAmpere}\n                            addKwRow={addKwRow}\n                            removeKwRow={removeKwRow}\n                            onGasTypeChange={handleGasTypeChange}\n                        />\n\n                    </div>\n\n                    <div className=\"lg:col-span-1 space-y-4\">\n                        <div className=\"bg-white rounded-xl shadow p-5\">\n                            <h3 className=\"text-lg font-semibold mb-2\">เลือกโมเดลเพื่อสรุปผล</h3>\n                            <select\n                                value={selectedModel}\n                                onChange={(e) => setSelectedModel(e.target.value === 'total' ? 'total' : Number(e.target.value))}\n                                className=\"w-full border rounded-lg px-3 py-2 bg-white border-blue-400 focus:ring-2 focus:ring-blue-400 text-base\"\n                            >\n                                {modelOptions.map((opt) => (\n                                    <option key={opt.value} value={opt.value}>\n                                        {opt.label}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <CostSummaryBill\n                            derived={derived}\n                            activeGas={summary.gasType}\n                            customRates={customRates}\n                            currentSelectionLabel={currentSelectionLabel}\n                        />\n                    </div>\n\n                </div>\n            </main>\n        </div>\n    );\n}\n\nexport default TakecoLaserCostV25;"],"names":[],"mappings":"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","debugId":null}}]
}